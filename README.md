# PDF格式转换工具

一个功能强大的PDF格式转换工具，支持将PDF文件转换为多种格式，包括Word文档、PowerPoint演示文稿、文本文件和图片。现已支持使用自定义PPT模板，让转换后的演示文稿更加美观专业。

## 功能特性

### 转换模式
- **文档模式**: 将PDF转换为文档格式
  - Word文档 (.docx)
  - PowerPoint演示文稿 (.pptx) - 支持自定义模板
  - 通过Word中转的PPT (.pptx) - 支持自定义模板
  - 纯文本文件 (.txt)
- **图片模式**: 将PDF转换为图片格式
  - PNG格式
  - JPG格式

### 转换方式
- **单文件转换**: 选择单个PDF文件进行转换
- **批量转换**: 选择文件夹，批量转换其中的所有PDF文件

### 其他特性
- 图形化用户界面，操作简单直观
- 可自定义输出目录
- **PPT转换**: 支持PDF转PPT，使用图片转换方案完美保留原始视觉效果
- 图片转换支持DPI设置（72-600）
- 实时转换进度显示
- 详细的转换日志
- 错误处理和状态反馈

## 系统要求

- Windows 7/8/10/11
- Python 3.7 或更高版本
- 至少 100MB 可用磁盘空间

## 安装步骤

### 1. 安装Python
如果您的系统中还没有安装Python，请从 [Python官网](https://www.python.org/downloads/) 下载并安装Python 3.7或更高版本。

### 2. 下载项目
```bash
git clone https://github.com/yourusername/pdf-converter.git
cd pdf-converter
```

或者直接下载ZIP文件并解压。

### 3. 安装依赖
在项目目录中打开命令提示符或PowerShell，运行以下命令：

```bash
pip install -r requirements.txt
```

### 4. 运行程序
```bash
python pdf_converter.py
```

## 使用说明

### 基本操作流程

1. **选择文件**
   - 点击"浏览文件"选择单个PDF文件
   - 或点击"浏览文件夹"选择包含PDF文件的文件夹进行批量转换

2. **选择转换模式**
   - **文档模式**: 提取PDF中的文本内容
   - **图片模式**: 将PDF页面转换为图片

3. **选择输出格式**
   - 文档模式: Word (.docx)、PowerPoint (.pptx)、通过Word中转的PPT (.pptx) 或 文本 (.txt)
   - 图片模式: PNG 或 JPG

4. **设置输出目录**
   - 选择转换后文件的保存位置
   - 默认为源文件所在目录

5. **调整设置**（可选）
   - 图片模式下可调整DPI设置（影响图片质量和文件大小）

6. **开始转换**
   - 点击"开始转换"按钮
   - 查看进度条和日志了解转换状态

### 输出文件命名规则

- **文档格式**: `原文件名.docx` 或 `原文件名.txt`
- **图片格式**: `原文件名_page页码.png` 或 `原文件名_page页码.jpg`

### 注意事项

1. **文档转换限制**
   - 转换为Word或文本格式时，复杂的排版可能无法完全保留
   - 图片、表格等非文本内容可能丢失或显示异常
   - 建议转换前备份原文件

2. **图片转换说明**
   - DPI设置越高，图片质量越好，但文件也越大
   - 推荐设置: 屏幕查看用150-300 DPI，打印用300-600 DPI
   - JPG格式文件更小，PNG格式质量更好

3. **PPT转换功能**
   - PPT转换使用默认空白样式，确保兼容性
   - 支持图片转换方案，完美保留PDF原始视觉效果
   - 支持两种PPT转换模式：
     - **直接转换**: 将PDF页面转换为图片并插入PPT
     - **Word中转**: 先转换为Word文档，再转换为PPT（保留更多文本信息）
   - 生成的PPT使用默认空白样式，确保最佳兼容性

### PPT转换说明

本工具使用图片转换方案进行PDF到PPT的转换：

- **转换方式**: 使用图片转换方案，完美保留PDF原始视觉效果
- **兼容性**: 使用默认空白样式，确保在所有PowerPoint版本中正常显示
- **质量保证**: 固定使用200 DPI确保图片清晰度
- **布局简洁**: 每页PDF对应一张PPT幻灯片，布局清晰
- **支持模式**: 
  - PowerPoint (.pptx) - 直接转换模式
  - PowerPoint via Word (.pptx) - 通过Word中转模式

#### 如何验证转换效果

1. **查看转换日志**:
   - 转换过程会显示: `使用图片转换方案，完美保留PDF原始视觉效果`

2. **检查转换后的PPT文件**:
   - 打开生成的PPT文件
   - 查看每页内容是否完整保留
   - 检查图片清晰度和布局效果

3. **性能提示**
   - 大文件或批量转换可能需要较长时间
   - 转换过程中请勿关闭程序
   - 确保有足够的磁盘空间存储输出文件

## 依赖库说明

- **PyMuPDF**: PDF文件处理和渲染
- **Pillow**: 图像处理和格式转换
- **python-docx**: Word文档创建和编辑
- **tkinter**: 图形用户界面（Python内置）

## 故障排除

### 常见问题

**Q: 程序无法启动**
A: 请检查Python版本是否为3.7+，并确保所有依赖库已正确安装。

**Q: 转换失败或结果异常**
A: 请检查PDF文件是否损坏，是否有密码保护，或者是否为扫描版PDF。

**Q: 内存不足错误**
A: 尝试降低DPI设置或分批处理大文件。

**Q: 中文显示乱码**
A: 确保系统支持UTF-8编码，或尝试更新相关字体。

### 获取帮助

如果遇到其他问题，请：
1. 查看程序日志窗口中的错误信息
2. 检查输入文件是否正常
3. 确认输出目录有写入权限
4. 重启程序后重试

## 更新日志

### v1.0.0 (2024-01-01)
- 初始版本发布
- 支持PDF转Word、TXT、PNG、JPG
- 支持单文件和批量转换
- 图形化用户界面
- 进度显示和日志记录

## 许可证

本项目采用MIT许可证，详见LICENSE文件。

## 贡献

欢迎提交Issue和Pull Request来改进这个项目。

---

**注意**: 本工具仅供学习和个人使用，请遵守相关版权法律法规。